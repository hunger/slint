import { Button, Palette } from "std-widgets.slint";
import { EditorSpaceSettings } from "../components/styling.slint";
import { Spreadsheet } from "../components/spreadsheet.slint";
import { Api, PreviewData } from "../api.slint";

import { WindowGlobal } from "../windowglobal.slint";

export component SpreadsheetDialog inherits Dialog {
    width: Math.min(self.preferred-width, WindowGlobal.window-width * 0.9);
    height: Math.min(self.preferred-height, WindowGlobal.window-height * 0.9);
    visible: false;

    title: "Edit Values";

    public function edit-in-spreadsheet(property-group-id: string, data: PreviewData) {
        spread-sheet.property-group-id = property-group-id;
        spread-sheet.preview-data = data;
        spread-sheet.current-table = Api.get-property-value-table(property-group-id, data.name);

        root.visible = true;
    }
    
    Rectangle {
        background: Palette.background;
        
        VerticalLayout {
            spread-sheet := Spreadsheet {
            }
        
            HorizontalLayout {
                alignment: end;
                padding: 8px;

                Button { 
                    text: "Close";
                    clicked => {
                        root.visible = false;
                    }
                }
            }
        }
    }
}
